{% extends 'main/base.html' %} {% load static i18n %}
<!-- prettier-ignore -->
{% block title %}
{% trans "Home - SITEX" %}
{% endblock %} {% block content %}

<!-- =========================================================
  HERO SECTION (SITEX Software Group)
========================================================= -->
<section class="hero-section position-relative overflow-hidden pt-6">
  <div class="container-fluid">
    <div class="row min-vh-75 py-5 g-0 align-items-stretch">
      <!-- Left: Banner / Carousel -->
      <div class="col-lg-6 position-relative" data-aos="fade-right">
        <div class="hero-image-container w-100 h-100 position-relative">
          <div
            id="homeBannerCarousel"
            class="carousel slide hero-carousel rounded-3 shadow-lg"
            data-bs-ride="carousel"
          >
            <div class="carousel-inner" id="bannerCarouselInner">
              <!-- Banners will be loaded here via JS -->
            </div>

            <button
              class="carousel-control-prev"
              type="button"
              data-bs-target="#homeBannerCarousel"
              data-bs-slide="prev"
            >
              <span
                class="carousel-control-prev-icon"
                aria-hidden="true"
              ></span>
              <span class="visually-hidden">{% trans "Previous" %}</span>
            </button>

            <button
              class="carousel-control-next"
              type="button"
              data-bs-target="#homeBannerCarousel"
              data-bs-slide="next"
            >
              <span
                class="carousel-control-next-icon"
                aria-hidden="true"
              ></span>
              <span class="visually-hidden">{% trans "Next" %}</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Right: Text / CTA -->
      <div
        class="col-lg-6 d-flex flex-column justify-content-center px-5 hero-content"
        data-aos="fade-left"
        data-aos-delay="200"
      >
        <span class="badge rounded-pill mb-3 mt-3 px-3 py-2 hero-badge">
          <i class="fas fa-code mx-2"></i>{% trans "SITEX Software Group" %}
        </span>

        <h1 class="display-3 fw-bold mb-4 hero-title">
          {% trans "Build Modern Software, Websites & Digital Platforms" %}
        </h1>

        <p class="lead mb-5 hero-subtitle">
          {% blocktrans %} We design and develop high-performance websites,
          business systems, and scalable cloud-ready solutions — with clean UI,
          secure architecture, and measurable results. {% endblocktrans %}
        </p>

        <div class="d-flex flex-wrap gap-3 mb-5">
          <!-- prettier-ignore -->
          <a href="#services" class="btn btn-lg px-4 py-3 hero-btn-primary">
            <i class="fas fa-layer-group mx-2"></i>
            {% trans "Explore Services" %}
          </a>

          <a
            href="{% url 'contact' %}"
            class="btn btn-lg px-4 py-3 hero-btn-outline"
          >
            <i class="fas fa-headset mx-2"></i>{% trans "Request a Quote" %}
          </a>
        </div>

        <div class="row g-4">
          <div class="col-6">
            <div class="d-flex align-items-center">
              <i
                class="fas fa-bolt fa-2x mx-3 hero-feature-icon hero-feature-icon-accent"
              ></i>
              <div>
                <h4 class="mb-0 hero-feature-value">Fast</h4>
                <small class="hero-feature-label"
                  >{% trans "Delivery & Iteration" %}</small
                >
              </div>
            </div>
          </div>

          <div class="col-6">
            <div class="d-flex align-items-center">
              <i
                class="fas fa-shield-halved fa-2x mx-3 hero-feature-icon hero-feature-icon-success"
              ></i>
              <div>
                <h4 class="mb-0 hero-feature-value">Secure</h4>
                <small class="hero-feature-label"
                  >{% trans "Best Practices" %}</small
                >
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- /Right -->
    </div>
  </div>

  <!-- Floating shapes -->
  <div class="floating-shape shape-1">
    <i class="fas fa-code fa-spin floating-icon floating-icon-primary"></i>
  </div>
  <div class="floating-shape shape-2">
    <i class="fas fa-cloud floating-icon floating-icon-secondary"></i>
  </div>
  <div class="floating-shape shape-3">
    <i class="fas fa-diagram-project floating-icon floating-icon-accent"></i>
  </div>
</section>

<!-- =========================================================
  COMPANY STATS (SITEX)
========================================================= -->
<section class="company-stats-section py-5 position-relative overflow-hidden">
  <div class="container position-relative z-1">
    <div class="section-header text-center mb-5">
      <span class="badge company-badge mb-3">
        <i class="fas fa-chart-line mx-2"></i>{% trans "Performance & Trust" %}
      </span>

      <h2 class="display-5 fw-bold mb-4 section-title">
        {% trans "Delivering Digital Excellence" %}
      </h2>

      <p class="lead mx-auto section-subtitle">
        {% blocktrans %} From corporate websites to internal systems, we focus
        on speed, stability, and a modern user experience — built for real
        business impact. {% endblocktrans %}
      </p>
    </div>

    <div class="row g-4">
      <!-- Client Satisfaction -->
      <div class="col-md-3 col-6 text-center" data-aos="fade-up">
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-accent">
            <i class="fas fa-face-smile-beam fa-3x"></i>
          </div>
          <h2 class="display-3 fw-bold mb-2 stat-number">
            <span class="counter" data-target="97">97</span>%
          </h2>
          <p class="fw-semibold mb-2 stat-label">
            {% trans "Client Satisfaction" %}
          </p>
          <small class="stat-note"
            >{% trans "Based on delivery & support feedback" %}</small
          >
          <div class="progress mt-2 stat-progress">
            <div
              class="progress-bar stat-bar stat-bar-accent"
              role="progressbar"
              aria-valuenow="97"
              aria-valuemin="0"
              aria-valuemax="100"
            ></div>
          </div>
        </div>
      </div>

      <!-- Uptime -->
      <div
        class="col-md-3 col-6 text-center"
        data-aos="fade-up"
        data-aos-delay="100"
      >
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-success">
            <i class="fas fa-server fa-3x"></i>
          </div>
          <h2 class="display-3 fw-bold mb-2 stat-number">
            <span class="counter" data-target="99.9">99.9</span>%
          </h2>
          <p class="fw-semibold mb-2 stat-label">{% trans "Uptime" %}</p>
          <small class="stat-note"
            >{% trans "Monitoring & stable deployments" %}</small
          >
          <div class="progress mt-2 stat-progress">
            <div
              class="progress-bar stat-bar stat-bar-success"
              role="progressbar"
              aria-valuenow="99.9"
              aria-valuemin="0"
              aria-valuemax="100"
            ></div>
          </div>
        </div>
      </div>

      <!-- Quality -->
      <div
        class="col-md-3 col-6 text-center"
        data-aos="fade-up"
        data-aos-delay="200"
      >
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-warning">
            <i class="fas fa-award fa-3x"></i>
          </div>
          <h2 class="display-3 fw-bold mb-2 stat-number">
            <span class="counter" data-target="100">100</span>%
          </h2>
          <p class="fw-semibold mb-2 stat-label">
            {% trans "Quality Standards" %}
          </p>
          <small class="stat-note"
            >{% trans "Code reviews & testing discipline" %}</small
          >
          <div class="progress mt-2 stat-progress">
            <div
              class="progress-bar stat-bar stat-bar-warning"
              role="progressbar"
              aria-valuenow="100"
              aria-valuemin="0"
              aria-valuemax="100"
            ></div>
          </div>
        </div>
      </div>

      <!-- Repeat Business -->
      <div
        class="col-md-3 col-6 text-center"
        data-aos="fade-up"
        data-aos-delay="300"
      >
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-primary">
            <i class="fas fa-handshake fa-3x"></i>
          </div>
          <h2 class="display-3 fw-bold mb-2 stat-number">
            <span class="counter" data-target="82">82</span>%
          </h2>
          <p class="fw-semibold mb-2 stat-label">
            {% trans "Returning Clients" %}
          </p>
          <small class="stat-note">{% trans "Long-term partnerships" %}</small>
          <div class="progress mt-2 stat-progress">
            <div
              class="progress-bar stat-bar stat-bar-primary"
              role="progressbar"
              aria-valuenow="82"
              aria-valuemin="0"
              aria-valuemax="100"
            ></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Additional Stats Row -->
    <div class="row g-4 mt-2">
      <div
        class="col-md-4 col-6 text-center"
        data-aos="fade-up"
        data-aos-delay="400"
      >
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-info">
            <i class="fas fa-headset fa-3x"></i>
          </div>
          <h2 class="display-4 fw-bold mb-2 stat-number">
            <span class="counter" data-target="24">24</span>/7
          </h2>
          <p class="fw-semibold mb-2 stat-label">{% trans "Support" %}</p>
          <small class="stat-note"
            >{% trans "Fast response & clear communication" %}</small
          >
        </div>
      </div>

      <div
        class="col-md-4 col-6 text-center"
        data-aos="fade-up"
        data-aos-delay="500"
      >
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-danger">
            <i class="fas fa-rocket fa-3x"></i>
          </div>
          <h2 class="display-4 fw-bold mb-2 stat-number">
            <span class="counter" data-target="7">7</span>+
          </h2>
          <p class="fw-semibold mb-2 stat-label">{% trans "Fast Launch" %}</p>
          <small class="stat-note"
            >{% trans "For MVP & landing websites" %}</small
          >
        </div>
      </div>

      <div
        class="col-md-4 col-6 text-center"
        data-aos="fade-up"
        data-aos-delay="600"
      >
        <div class="company-stat-card p-4 position-relative">
          <div class="stat-icon-wrapper mb-3 stat-color-success">
            <i class="fas fa-lock fa-3x"></i>
          </div>
          <h2 class="display-4 fw-bold mb-2 stat-number">
            <span class="counter" data-target="12">12</span>+
          </h2>
          <p class="fw-semibold mb-2 stat-label">
            {% trans "Security Checks" %}
          </p>
          <small class="stat-note"
            >{% trans "Hardening & best practices" %}</small
          >
        </div>
      </div>
    </div>

    <!-- Trust badges -->
    <div class="row mt-5 pt-3">
      <div class="col-12 text-center">
        <div
          class="d-flex flex-wrap justify-content-center align-items-center gap-4"
        >
          <div
            class="cert-badge rounded-pill px-4 py-2 d-flex align-items-center"
          >
            <i class="fas fa-code-branch text-warning mx-2"></i>
            <span>{% trans "Clean Git Workflow" %}</span>
          </div>
          <div
            class="cert-badge rounded-pill px-4 py-2 d-flex align-items-center"
          >
            <i class="fas fa-shield-halved text-success mx-2"></i>
            <span>{% trans "Secure by Design" %}</span>
          </div>
          <div
            class="cert-badge rounded-pill px-4 py-2 d-flex align-items-center"
          >
            <i class="fas fa-cloud text-info mx-2"></i>
            <span>{% trans "Cloud-Ready Deployments" %}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="position-absolute top-0 start-0 w-100 h-100 opacity-5">
    <div class="pattern-dots"></div>
  </div>

  <div class="floating-shape shape-1">
    <i class="fas fa-code fa-spin floating-icon floating-icon-primary"></i>
  </div>
  <div class="floating-shape shape-2">
    <i class="fas fa-cloud floating-icon floating-icon-secondary"></i>
  </div>
  <div class="floating-shape shape-3">
    <i class="fas fa-diagram-project floating-icon floating-icon-accent"></i>
  </div>
</section>

<!-- =========================================================
  SERVICES SECTION (replaces Categories)
========================================================= -->
<section id="services" class="py-5">
  <div class="container">
    <div class="section-header text-center mb-5">
      <span class="badge section-pill-badge mb-3 px-3 py-2 rounded-pill">
        <i class="fas fa-layer-group mx-2"></i>{% trans "Our Services" %}
      </span>
      <h2 class="display-5 fw-bold mb-4 section-title-home">
        {% trans "What We Build" %}
      </h2>
      <!-- prettier-ignore -->
      <p class="lead text-muted mx-auto section-max-600">
        {% blocktrans %} Websites, systems, and digital products — engineered
        for performance, scalability, and a great user experience.
        {% endblocktrans %}
      </p>
    </div>

    <div class="row g-4" id="servicesContainer">
      <!-- Services will be loaded here via JS -->
    </div>
  </div>
</section>

<!-- =========================================================
  TECHNOLOGIES / PARTNERS (replaces Brands)
========================================================= -->
<section class="py-5">
  <div class="container">
    <div class="section-header text-center mb-5">
      <span class="badge section-pill-badge mb-3 px-3 py-2 rounded-pill">
        <i class="fas fa-cubes mx-2"></i>{% trans "Technologies" %}
      </span>
      <h2 class="display-5 fw-bold mb-4 section-title-home">
        {% trans "Modern Stack, Reliable Delivery" %}
      </h2>
      <p class="lead text-muted mx-auto section-max-600">
        {% blocktrans %} We use trusted technologies and proven engineering
        practices to ship stable products faster. {% endblocktrans %}
      </p>
    </div>

    <div class="row g-4 align-items-center" id="techContainer">
      <!-- Tech/partners will be loaded here via JS -->
    </div>
  </div>
</section>

<!-- =========================================================
  FEATURED PROJECTS (replaces Featured Products)
========================================================= -->
<section id="featured-projects" class="py-5 section-alt">
  <div class="container">
    <div class="section-header text-center mb-5">
      <span class="badge section-pill-badge mb-3 px-3 py-2 rounded-pill">
        <i class="fas fa-briefcase mx-2"></i>{% trans "Featured Work" %}
      </span>
      <h2 class="display-5 fw-bold mb-4 section-title-home">
        {% trans "Projects & Case Studies" %}
      </h2>
      <p class="lead text-muted mx-auto section-max-600">
        {% blocktrans %} A selection of websites and systems delivered with care
        — UI, backend, integrations, and deployment. {% endblocktrans %}
      </p>
    </div>

    <div class="row g-4" id="featuredProjectsContainer">
      <!-- Featured projects will be loaded here via JS -->
    </div>

    <div class="text-center mt-5">
      <a
        href="{% url 'categories' %}"
        class="btn btn-industrial text-muted btn-lg px-5 border"
      >
        <i class="fas fa-eye mx-2"></i>{% trans "View All Services" %}
      </a>
    </div>
  </div>
</section>

<style>
  /* =========================================================
     Base theme bindings (keep)
  ========================================================= */
  .hero-section,
  .company-stats-section {
    background: var(--bg-color);
    color: var(--text-color);
  }

  .hero-title,
  .hero-subtitle,
  .hero-feature-value,
  .hero-feature-label,
  .section-title,
  .company-stats-section .section-title,
  .company-stat-card .stat-number,
  .company-stat-card .stat-label,
  .company-stat-card .stat-note {
    color: var(--text-color);
  }

  .hero-subtitle,
  .hero-feature-label,
  .company-stat-card .stat-note {
    opacity: 0.75;
  }

  .hero-badge {
    background: var(--primary);
    color: var(--light);
  }

  .hero-btn-primary {
    background: var(--primary);
    color: var(--light);
    border: none;
    position: relative;
    overflow: hidden;
  }
  .hero-btn-primary:hover {
    filter: brightness(0.95);
    color: var(--light);
  }

  .hero-btn-outline {
    background: transparent;
    border: 2px solid var(--primary);
    color: var(--primary);
    position: relative;
    overflow: hidden;
  }
  .hero-btn-outline:hover {
    background: var(--primary);
    color: var(--light);
  }

  .hero-feature-icon-accent {
    color: var(--accent);
  }
  .hero-feature-icon-success {
    color: var(--success);
  }

  /* =========================================================
     Fixed Carousel height
  ========================================================= */
  .hero-carousel {
    height: clamp(320px, 728px, 728px);
    overflow: hidden;
  }
  .hero-carousel .carousel-inner {
    height: 100%;
    overflow: hidden;
    border-radius: inherit;
  }
  .hero-carousel .carousel-item {
    width: 100%;
    height: 100%;
  }

  .banner-item {
    height: 100%;
    position: relative;
    overflow: hidden;
  }
  .banner-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .banner-content {
    position: absolute;
    inset-inline: 0;
    bottom: 0;
    padding: 1.5rem;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
    color: #fff;
  }
  .banner-title {
    font-size: 1.75rem;
    color: #fff;
  }

  @media (max-width: 576px) {
    .hero-carousel {
      height: clamp(260px, 45vh, 520px);
    }
    .banner-content {
      padding: 1rem;
    }
    .hero-content {
      padding-inline: 1rem !important;
    }
    .hero-title {
      font-size: 2rem;
    }
    .hero-subtitle {
      font-size: 1rem;
    }
  }

  /* =========================================================
     Services / Tech / Projects cards (reuse your card style)
  ========================================================= */
  .service-card,
  .tech-card,
  .project-card {
    transition: all 0.3s ease;
    height: 100%;
    border: 1px solid var(--card-border-color);
    border-radius: 16px;
    background: var(--card-bg);
    box-shadow: var(--card-shadow);
  }
  .service-card:hover,
  .tech-card:hover,
  .project-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 35px rgba(0, 0, 0, 0.15);
    border-color: rgba(37, 99, 235, 0.35);
  }
  .card-icon {
    width: 56px;
    height: 56px;
    border-radius: 14px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: rgba(37, 99, 235, 0.1);
    color: var(--primary);
  }

  /* =========================================================
     Company statistics cards (keep)
  ========================================================= */
  .company-badge {
    background: var(--primary);
    color: var(--light);
    padding: 0.5rem 1rem;
    border-radius: 50px;
  }
  .section-subtitle,
  .section-max-600 {
    max-width: 600px;
  }

  .company-stat-card {
    background: var(--card-bg);
    border: 1px solid var(--card-border-color);
    box-shadow: var(--card-shadow);
    border-radius: 16px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    backdrop-filter: blur(10px);
    height: 100%;
    position: relative;
    overflow: hidden;
    z-index: 1;
  }
  .company-stat-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
  }
  .stat-progress {
    height: 4px;
    border-radius: 10px;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.1);
  }
  .stat-bar {
    width: 0%;
    border-radius: 10px;
    transition: width 1.5s ease-in-out;
  }
  .stat-bar-accent {
    background: var(--accent);
  }
  .stat-bar-success {
    background: var(--success);
  }
  .stat-bar-warning {
    background: var(--warning);
  }
  .stat-bar-primary {
    background: var(--primary);
  }

  .stat-color-accent {
    color: var(--accent);
  }
  .stat-color-success {
    color: var(--success);
  }
  .stat-color-warning {
    color: var(--warning);
  }
  .stat-color-primary {
    color: var(--primary);
  }
  .stat-color-info {
    color: var(--primary-light);
  }
  .stat-color-danger {
    color: var(--danger);
  }

  .cert-badge {
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(5px);
    background: rgba(255, 255, 255, 0.1);
  }
  .cert-badge:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-3px);
  }

  .pattern-dots {
    width: 100%;
    height: 100%;
    background-image: radial-gradient(
        rgba(255, 255, 255, 0.1) 2px,
        transparent 2px
      ),
      radial-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px);
    background-size: 50px 50px, 25px 25px;
    background-position: 0 0, 25px 25px;
  }

  .floating-shape {
    position: absolute;
    font-size: 2rem;
    opacity: 0.1;
    z-index: 0;
  }
  .shape-1 {
    top: 20%;
    inset-inline-start: 5%;
    animation: float 8s ease-in-out infinite;
  }
  .shape-2 {
    top: 60%;
    inset-inline-end: 10%;
    animation: float 10s ease-in-out infinite reverse;
  }
  .shape-3 {
    bottom: 20%;
    inset-inline-start: 15%;
    animation: float 12s ease-in-out infinite;
  }

  .floating-icon-primary {
    color: var(--primary);
  }
  .floating-icon-secondary {
    color: var(--secondary);
  }
  .floating-icon-accent {
    color: var(--accent);
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0) rotate(0deg);
    }
    33% {
      transform: translateY(-20px) rotate(120deg);
    }
    66% {
      transform: translateY(10px) rotate(240deg);
    }
  }

  @media (max-width: 768px) {
    .floating-shape {
      display: none;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    AOS.init({ duration: 800, once: true, offset: 100 });

    // ========= DATA LOAD =========
    async function loadHomeData() {
      try {
        const response = await fetch("{% url 'api-home-data' %}");
        if (!response.ok)
          throw new Error(`HTTP error! status: ${response.status}`);

        const data = await response.json();
        if (!data.success)
          throw new Error(data.error || "Failed to load home data");

        loadBanners(data.banners || []);
        loadServices(data.categories || data.services || []); // reuse old key if your API still sends categories
        loadTech(data.brands || data.tech || []); // reuse old key if your API still sends brands
        loadFeaturedProjects(data.projects || []);
      } catch (error) {
        console.error("Error loading home data:", error);
        showErrorMessages();
      }
    }

    // ========= HERO SLIDES =========
    function slideHTML({
      isActive,
      imgUrl,
      title,
      subtitle,
      btnText,
      btnLink,
    }) {
      return `
        <div class="carousel-item ${isActive ? "active" : ""}">
          <div class="banner-item">
            ${
              imgUrl
                ? `<img src="${imgUrl}" alt="${
                    title || "Banner"
                  }" loading="eager" decoding="async">`
                : `<div class="bg-primary h-100 d-flex align-items-center justify-content-center">
                     <div class="text-center text-white px-4">
                       <h2 class="fw-bold mb-2">${title || "SITEX"}</h2>
                       <p class="mb-0 opacity-75">${subtitle || ""}</p>
                     </div>
                   </div>`
            }
            <div class="banner-content">
              ${
                title
                  ? `<h3 class="fw-bold mb-1 banner-title">${title}</h3>`
                  : ""
              }
              ${subtitle ? `<p class="mb-0 opacity-75">${subtitle}</p>` : ""}
              ${
                btnText
                  ? `<a href="${btnLink || "#"}" class="btn btn-light mt-3">
                       <i class="fas fa-arrow-right mx-2"></i>${btnText}
                     </a>`
                  : ""
              }
            </div>
          </div>
        </div>
      `;
    }

    function loadBanners(banners) {
      const container = document.getElementById("bannerCarouselInner");
      if (!container) return;

      if (!banners || banners.length === 0) {
        container.innerHTML = slideHTML({
          isActive: true,
          imgUrl: "{% static 'main/img/hero-sitex.jpg' %}",
          title: "{% trans 'Websites & Systems that Perform' %}",
          subtitle:
            "{% trans 'Modern UI, secure backend, reliable deployment' %}",
          btnText: "",
          btnLink: "#",
        });

        const img = container.querySelector("img");
        if (img) {
          img.onerror = function () {
            this.src =
              "https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=1400&q=80";
          };
        }
      } else {
        container.innerHTML = banners
          .map((b, i) =>
            slideHTML({
              isActive: i === 0,
              imgUrl: b.image || "",
              title: b.title || "",
              subtitle: b.subtitle || "",
              btnText: b.button_text || "",
              btnLink: b.button_link || "#",
            })
          )
          .join("");
      }

      const el = document.getElementById("homeBannerCarousel");
      if (el) {
        bootstrap.Carousel.getInstance(el)?.dispose();
        if ((banners || []).length > 1)
          new bootstrap.Carousel(el, { interval: 5000, ride: "carousel" });
      }
    }

    // ========= SERVICES (replaces Categories) =========
    function loadServices(services) {
      const container = document.getElementById("servicesContainer");
      if (!container) return;

      if (!services || services.length === 0) {
        container.innerHTML = `
          <div class="col-12 text-center py-4">
            <p class="text-muted">{% trans "No services available." %}</p>
          </div>
        `;
        return;
      }

      container.innerHTML = "";
      services.forEach((s, index) => {
        const delay = index * 80;

        const name = s.name || s.title || "{% trans 'Service' %}";
        const desc = s.description || "";
        const icon = s.icon || getServiceIcon(index);
        const link = s.url || s.link || "/our-services/";

        container.insertAdjacentHTML(
          "beforeend",
          `
          <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="${delay}">
            <a href="${link}" class="text-decoration-none">
              <div class="service-card p-4">
                <div class="d-flex align-items-center justify-content-between mb-3">
                  <div class="card-icon">
                    <i class="${icon}"></i>
                  </div>
                  <i class="fas fa-arrow-right text-muted"></i>
                </div>
                <h5 class="fw-bold mb-2" style="color: var(--text-color);">${name}</h5>
                <p class="text-muted mb-0" style="font-size:0.95rem;">
                  ${
                    desc
                      ? desc.length > 110
                        ? desc.substring(0, 110) + "..."
                        : desc
                      : "{% trans 'Details available on request.' %}"
                  }
                </p>
              </div>
            </a>
          </div>
        `
        );
      });
    }

    function getServiceIcon(index) {
      const icons = [
        "fas fa-globe",
        "fas fa-laptop-code",
        "fas fa-gear",
        "fas fa-mobile-screen-button",
        "fas fa-cloud",
        "fas fa-shield-halved",
        "fas fa-database",
        "fas fa-diagram-project",
      ];
      return icons[index % icons.length];
    }

    // ========= TECHNOLOGIES (replaces Brands) =========
    function loadTech(items) {
      const container = document.getElementById("techContainer");
      if (!container) return;

      if (!items || items.length === 0) {
        container.innerHTML = `
          <div class="col-12 text-center py-4">
            <p class="text-muted">{% trans "No technologies available." %}</p>
          </div>
        `;
        return;
      }

      container.innerHTML = "";
      items.forEach((t, index) => {
        const delay = index * 50;

        const name = t.name || t.title || "Tech";
        const description = t.description || "";
        const image = t.image || t.logo || t.logo_url || t.image_url || null;

        container.insertAdjacentHTML(
          "beforeend",
          `
          <div class="col-lg-3 col-md-4 col-6" data-aos="fade-up" data-aos-delay="${delay}">
            <div class="tech-card text-center p-4">
              <div class="mb-3 d-flex align-items-center justify-content-center" style="height: 56px;">
                ${
                  image
                    ? `<img src="${image}" alt="${name}" class="img-fluid" style="max-height:56px;width:auto;">`
                    : `<div class="card-icon mx-auto"><i class="fas fa-cubes"></i></div>`
                }
              </div>
              <h6 class="fw-bold mb-1" style="color: var(--text-color);">${name}</h6>
              <small class="text-muted">${description || ""}</small>
            </div>
          </div>
        `
        );
      });
    }

    // ========= FEATURED PROJECTS (replaces Featured Products) =========
    function loadFeaturedProjects(projects) {
      const container = document.getElementById("featuredProjectsContainer");
      if (!container) return;

      if (!projects || projects.length === 0) {
        container.innerHTML = `
          <div class="col-12 text-center py-4">
            <p class="text-muted">{% trans "No featured work available." %}</p>
          </div>
        `;
        return;
      }

      container.innerHTML = "";
      projects.forEach((p, index) => {
        const delay = index * 60;

        const name = p.name || p.title || "{% trans 'Project' %}";
        const description = p.description || "";
        const image = p.image || p.thumbnail || null;
        const link = p.url || p.link || "/our-services/";

        container.insertAdjacentHTML(
          "beforeend",
          `
          <div class="col-lg-3 col-md-4 col-6" data-aos="fade-up" data-aos-delay="${delay}">
            <a href="${link}" class="text-decoration-none">
              <div class="project-card p-3 position-relative">
                <div class="mb-3" style="border-radius: 14px; overflow:hidden; background: rgba(37,99,235,0.06); height: 190px; display:flex; align-items:center; justify-content:center;">
                  ${
                    image
                      ? `<img src="${image}" alt="${name}" class="img-fluid" style="width:100%;height:100%;object-fit:cover;">`
                      : `<i class="fas fa-window-restore text-muted fa-3x"></i>`
                  }
                </div>

                <h6 class="fw-bold mb-2 text-truncate" style="color: var(--text-color);">${name}</h6>

                ${
                  description
                    ? `<p class="text-muted small mb-0" style="font-size:0.9rem;">
                         ${
                           description.length > 95
                             ? description.substring(0, 95) + "..."
                             : description
                         }
                       </p>`
                    : `<p class="text-muted small mb-0" style="font-size:0.9rem;">{% trans "Project details available." %}</p>`
                }
              </div>
            </a>
          </div>
        `
        );
      });
    }

    function showErrorMessages() {
      const containers = [
        "servicesContainer",
        "techContainer",
        "featuredProjectsContainer",
      ];
      containers.forEach((id) => {
        const el = document.getElementById(id);
        if (el) {
          el.innerHTML = `
            <div class="col-12 text-center py-4">
              <p class="text-danger">
                <i class="fas fa-exclamation-triangle mx-2"></i>
                {% trans "Failed to load content. Please try again later." %}
              </p>
            </div>
          `;
        }
      });
    }

    // Animate stat progress bars
    function initStatBars() {
      document.querySelectorAll(".stat-bar").forEach((bar) => {
        const val = bar.getAttribute("aria-valuenow");
        if (val) bar.style.width = val + "%";
      });
    }
    initStatBars();

    loadHomeData();
  });
</script>

{% endblock %}
